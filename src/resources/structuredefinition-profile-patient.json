{
  "resourceType": "StructureDefinition",
  "id": "profile-patient",
  "url": "http://hl7.org/fhir/ca/core/StructureDefinition/profile-patient",
  "version": "0.1.0",
  "name": "PatientProfile",
  "title": "Patient Profile",
  "status": "draft",
  "date": "2019-12-18",
  "publisher": "Canada Health Infoway",
  "description": "Proposed constraints and extensions on the Patient Resource",
  "kind": "resource",
  "abstract": false,
  "type": "Patient",
  "baseDefinition": "http://hl7.org/fhir/StructureDefinition/Patient",
  "derivation": "constraint",
  "differential": {
    "element": [
      {
        "id": "Patient",
        "path": "Patient",
        "short": "Patient Profile",
        "definition": "The Patient Profile is based upon the core FHIR Patient Resource",
        "mustSupport": true,
        "isModifier": false
      },
      {
        "id": "Patient.extension",
        "path": "Patient.extension",
        "slicing": {
          "discriminator": [
            {
              "type": "value",
              "path": "url"
            }
          ],
          "rules": "open"
        }
      },
      {
        "id": "Patient.extension:birthsex",
        "path": "Patient.extension",
        "sliceName": "birthsex",
        "short": "Extension: Sex at Birth",
        "definition": "A code classifying the person's sex assigned at birth  as specified by the [TODO: assigning authority]. This extension aligns with the C-CDA Birth Sex Observation (LOINC 76689-9)",
        "min": 0,
        "max": "1",
        "type": [
          {
            "code": "Extension",
            "profile": [
              "http://hl7.org/fhir/ca/core/StructureDefinition/ext-patientbirthsex"
            ]
          }
        ],
        "mustSupport": false
      },
      {
        "id": "Patient.extension:birthsex.url",
        "path": "Patient.extension.url",
        "min": 1,
        "fixedUri": "http://hl7.org/fhir/ca/core/StructureDefinition/ext-patientbirthsex"
      },
      {
        "id": "Patient.extension:birthsex.value[x]:valueCoding",
        "path": "Patient.extension.value[x]",
        "sliceName": "valueCoding",
        "min": 1,
        "max": "1",
        "type": [
          {
            "code": "Coding"
          }
        ],
        "binding": {
          "strength": "example",
          "description": "A collection of codes specifying sex assigned at birth",
          "valueSet": "http://hl7.org/fhir/ca/core/ValueSet/birthsex"
        }
      },
      {
        "id": "Patient.extension:birthsex.value[x]:valueCoding.system",
        "path": "Patient.extension.value[x].system",
        "min": 1
      },
      {
        "id": "Patient.extension:birthsex.value[x]:valueCoding.code",
        "path": "Patient.extension.value[x].code",
        "min": 1
      },
      {
        "id": "Patient.extension:birthsex.value[x]:valueCoding.display",
        "path": "Patient.extension.value[x].display",
        "short": "Optional description of the sex at birth code",
        "definition": "Plain text representation of the sex at birth concept"
      },
      {
        "id": "Patient.extension:ethnicity",
        "path": "Patient.extension",
        "sliceName": "ethnicity",
        "short": "Extension: ethnicity extension",
        "definition": "A code classifying the person's ethnic group or ethnicity as the category of people who identify with each other, usually on the basis of a presumed common genealogy or ancestry or on other similarities.",
        "comment": "This attribute is based on the belief of the person or the person reporting the attribute, not on any formal analysis of genetic, geneological or historical relationships as these would need to be captured as observations.",
        "min": 0,
        "max": "1",
        "type": [
          {
            "code": "Extension",
            "profile": [
              "http://hl7.org/fhir/ca/core/StructureDefinition/ext-ethnicity"
            ]
          }
        ],
        "mustSupport": false,
        "isModifier": false,
        "mapping": [
          {
            "identity": "HL7v2",
            "map": "PID.22 [Ethnic Group]",
            "comment": "This field further defines the patient's ancestry.  Refer to User-defined Table 0189 - Ethnic Group in Chapter 2C, Code Tables, for suggested values."
          },
          {
            "identity": "rim",
            "map": "Person.ethnicGroupCode",
            "comment": "A code classifying the person into a named category of humans sharing a common real or presumed heritage"
          },
          {
            "identity": "CDA",
            "map": "/ClinicalDocument/recordTarget/patientRole/patient/sdtc:ethnicGroupCode",
            "comment": "This CDA R2 SDTC ethnicGroupCode extension is used to record additional ethnicity groups for the recordTarget or subjectPerson"
          }
        ]
      },
      {
        "id": "Patient.extension:ethnicity.url",
        "path": "Patient.extension.url",
        "min": 1,
        "fixedUri": "http://hl7.org/fhir/ca/core/StructureDefinition/ext-ethnicity"
      },
      {
        "id": "Patient.extension:ethnicity.value[x]:valueCoding",
        "path": "Patient.extension.value[x]",
        "sliceName": "valueCoding",
        "definition": "Concepts classifying the person into a named category of humans sharing common history, traits, geographical origin or nationality",
        "min": 1,
        "max": "1",
        "type": [
          {
            "code": "Coding"
          }
        ],
        "example": [
          {
            "label": "Example of the Ethnicity extension",
            "valueCoding": {
              "system": "http://snomed.info/sct",
              "code": "733446001",
              "display": "Canadian (ethnic group)"
            }
          }
        ],
        "binding": {
          "strength": "preferred",
          "description": "One of [self-reported ethnic group codes](https://tgateway.infoway-inforoute.ca/vs/ethnicitycode) representing the ethnicity concept and should not be confused with citizenship or nationality.",
          "valueSet": "https://fhir.infoway-inforoute.ca/ValueSet/ethnicitycode"
        },
        "mapping": [
          {
            "identity": "HL7v2",
            "map": "PID.22 [Ethnic Group]",
            "comment": "This field further defines the patient's ancestry.  Refer to User-defined Table 0189 - Ethnic Group in Chapter 2C, Code Tables, for suggested values."
          },
          {
            "identity": "rim",
            "map": "Person.ethnicGroupCode",
            "comment": "A code classifying the person into a named category of humans sharing a common real or presumed heritage"
          },
          {
            "identity": "CDA",
            "map": "/ClinicalDocument/recordTarget/patientRole/patient/sdtc:ethnicGroupCode",
            "comment": "This CDA R2 SDTC ethnicGroupCode extension is used to record additional ethnicity groups for the recordTarget or subjectPerson"
          }
        ]
      },
      {
        "id": "Patient.extension:ethnicity.value[x]:valueCoding.system",
        "path": "Patient.extension.value[x].system",
        "short": "Identity of the terminology system",
        "comment": "Expected URI is one of the following: SNOMED CT International (http://snomed.info/sct) or SNOMED CT CA Edition (https://fhir.infoway-inforoute.ca/CodeSystem/snomedctcaextension)",
        "min": 1
      },
      {
        "id": "Patient.extension:ethnicity.value[x]:valueCoding.code",
        "path": "Patient.extension.value[x].code",
        "short": "Code defining ethnicity concept",
        "definition": "One of [self-reported ethnic group codes](https://tgateway.infoway-inforoute.ca/vs/ethnicitycode) representing the ethnicity concept and should not be confused with citizenship or nationality.",
        "min": 1
      },
      {
        "id": "Patient.extension:ethnicity.value[x]:valueCoding.display",
        "path": "Patient.extension.value[x].display",
        "short": "Optional description of the ethnicity code",
        "definition": "Plain text representation of the ethnicity concept"
      },
      {
        "id": "Patient.identifier",
        "path": "Patient.identifier",
        "slicing": {
          "discriminator": [
            {
              "type": "pattern",
              "path": "type"
            }
          ],
          "rules": "open"
        },
        "min": 0
      },
      {
        "id": "Patient.identifier.type",
        "path": "Patient.identifier.type",
        "min": 1,
        "example": [
          {
            "label": "Pattern",
            "valueCodeableConcept": {
              "coding": [
                {
                  "system": "http://terminology.hl7.org/CodeSystem/v2-0203",
                  "code": "MR"
                }
              ]
            }
          }
        ],
        "mustSupport": true
      },
      {
        "id": "Patient.identifier.system",
        "path": "Patient.identifier.system",
        "min": 1,
        "mustSupport": true,
        "isModifier": false
      },
      {
        "id": "Patient.identifier.value",
        "path": "Patient.identifier.value",
        "short": "The value that is unique within the system.",
        "min": 1,
        "mustSupport": true,
        "isModifier": false
      },
      {
        "id": "Patient.identifier:PPN",
        "path": "Patient.identifier",
        "sliceName": "PPN",
        "short": "Canada Passport Number",
        "example": [
          {
            "label": "Canada Passport Number identifier example",
            "valueIdentifier": {
              "type": {
                "coding": [
                  {
                    "system": "http://terminology.hl7.org/CodeSystem/v2-0203",
                    "code": "PPN"
                  }
                ]
              },
              "system": "https://fhir.infoway-inforoute.ca/NamingSystem/ca-passport-number",
              "value": "AB123456",
              "period": {
                "start": "2005-05-11",
                "end": "2015-05-11"
              }
            }
          }
        ],
        "mustSupport": false
      },
      {
        "id": "Patient.identifier:PPN.type",
        "path": "Patient.identifier.type",
        "short": "Passport number identifier type",
        "min": 1,
        "max": "1",
        "fixedCodeableConcept": {
          "coding": [
            {
              "system": "http://terminology.hl7.org/CodeSystem/v2-0203",
              "code": "PPN"
            }
          ]
        }
      },
      {
        "id": "Patient.identifier:PPN.system",
        "path": "Patient.identifier.system",
        "short": "A Canadian passport number Naming System from the Canadian URI Registry",
        "min": 1,
        "max": "1",
        "fixedUri": "https://fhir.infoway-inforoute.ca/NamingSystem/ca-passport-number"
      },
      {
        "id": "Patient.identifier:PPN.value",
        "path": "Patient.identifier.value",
        "short": "A Canadian passport number",
        "min": 1,
        "max": "1"
      },
      {
        "id": "Patient.identifier:JPID",
        "path": "Patient.identifier",
        "sliceName": "JPID",
        "short": "Federal Patient identifiers",
        "definition": "Federal patient and person identifiers used by all jurisdictions across Canada",
        "mustSupport": false
      },
      {
        "id": "Patient.identifier:JPID.type",
        "path": "Patient.identifier.type",
        "short": "Jurisdictional Person Identification",
        "min": 1,
        "max": "1",
        "fixedCodeableConcept": {
          "coding": [
            {
              "system": "http://terminology.hl7.org/CodeSystem/v2-0203",
              "code": "JPID"
            }
          ]
        }
      },
      {
        "id": "Patient.identifier:JPID.system",
        "path": "Patient.identifier.system",
        "short": "Jurisdictional Person identification Naming System from the Canadian URI Registry",
        "min": 1,
        "max": "1",
        "example": [
          {
            "label": "Canada, Social Insurance Number system URI",
            "valueUri": "https://fhir.infoway-inforoute.ca/NamingSystem/ca-social-insurance-number"
          }
        ]
      },
      {
        "id": "Patient.identifier:JPID.value",
        "path": "Patient.identifier.value",
        "short": "Jurisdictional Person identification number",
        "min": 1,
        "max": "1",
        "example": [
          {
            "label": "Canada, Social Insurance Number (SIN)",
            "valueString": "924123456"
          }
        ]
      },
      {
        "id": "Patient.identifier:JHN",
        "path": "Patient.identifier",
        "sliceName": "JHN",
        "short": "Jurisdictional Health Number",
        "definition": "Federal patient and person health numbers used by all jurisdictions across Canada"
      },
      {
        "id": "Patient.identifier:JHN.extension",
        "path": "Patient.identifier.extension",
        "slicing": {
          "discriminator": [
            {
              "type": "value",
              "path": "url"
            }
          ],
          "rules": "open"
        }
      },
      {
        "id": "Patient.identifier:JHN.extension:versionCode",
        "path": "Patient.identifier.extension",
        "sliceName": "versionCode",
        "short": "Health Number Version Code",
        "type": [
          {
            "code": "Extension",
            "profile": [
              "http://hl7.org/fhir/ca/core/StructureDefinition/ext-identifierversion"
            ]
          }
        ]
      },
      {
        "id": "Patient.identifier:JHN.type",
        "path": "Patient.identifier.type",
        "min": 1,
        "fixedCodeableConcept": {
          "coding": [
            {
              "system": "http://terminology.hl7.org/CodeSystem/v2-0203",
              "code": "JHN"
            }
          ]
        },
        "mustSupport": true
      },
      {
        "id": "Patient.identifier:JHN.system",
        "path": "Patient.identifier.system",
        "short": "A Health Number Naming System from the Canadian URI Registry",
        "min": 1,
        "example": [
          {
            "label": "Canada Armed Forces health card number system URI",
            "valueUri": "https://fhir.infoway-inforoute.ca/NamingSystem/ca-armed-forces-health-id"
          }
        ]
      },
      {
        "id": "Patient.identifier:JHN.value",
        "path": "Patient.identifier.value",
        "min": 1,
        "example": [
          {
            "label": "Canada Armed Forces health card number",
            "valueString": "A91234569"
          }
        ]
      },
      {
        "id": "Patient.name",
        "path": "Patient.name",
        "min": 1,
        "constraint": [
          {
            "key": "ca-core-name",
            "severity": "error",
            "human": "Patient.name.given  or Patient.name.family or both SHALL be present",
            "expression": "family.exists() or given.exists()",
            "xpath": "f:given or f:family"
          }
        ],
        "mustSupport": true
      },
      {
        "id": "Patient.name.family",
        "path": "Patient.name.family"
      },
      {
        "id": "Patient.name.given",
        "path": "Patient.name.given"
      },
      {
        "id": "Patient.telecom",
        "path": "Patient.telecom",
        "mustSupport": true
      },
      {
        "id": "Patient.telecom.system",
        "path": "Patient.telecom.system",
        "min": 1
      },
      {
        "id": "Patient.telecom.value",
        "path": "Patient.telecom.value",
        "min": 1
      },
      {
        "id": "Patient.birthDate",
        "path": "Patient.birthDate",
        "mustSupport": true
      },
      {
        "id": "Patient.address",
        "path": "Patient.address"
      },
      {
        "id": "Patient.address.extension",
        "path": "Patient.address.extension",
        "slicing": {
          "discriminator": [
            {
              "type": "value",
              "path": "url"
            }
          ],
          "rules": "open"
        }
      },
      {
        "id": "Patient.address.extension:preferred",
        "path": "Patient.address.extension",
        "sliceName": "preferred",
        "short": "HL7 Preferred Address Flag extension",
        "definition": "Flag denoting whether parent address item is preferred",
        "min": 0,
        "max": "1",
        "type": [
          {
            "code": "Extension",
            "profile": [
              "http://hl7.org/fhir/StructureDefinition/iso21090-preferred"
            ]
          }
        ]
      },
      {
        "id": "Patient.address.extension:preferred.url",
        "path": "Patient.address.extension.url",
        "fixedUri": "http://hl7.org/fhir/StructureDefinition/iso21090-preferred"
      },
      {
        "id": "Patient.address.extension.value[x]",
        "path": "Patient.address.extension.value[x]",
        "slicing": {
          "discriminator": [
            {
              "type": "type",
              "path": "$this"
            }
          ]
        },
        "definition": "Flag denoting whether address item is preferred",
        "comment": "A person may have more than one address and indicate the preferred address to contact",
        "min": 1,
        "max": "1",
        "type": [
          {
            "code": "boolean"
          }
        ]
      }
    ]
  }
}
